var A=Object.defineProperty,I=Object.defineProperties;var j=Object.getOwnPropertyDescriptors;var S=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var C=(c,l,a)=>l in c?A(c,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):c[l]=a,W=(c,l)=>{for(var a in l||(l={}))B.call(l,a)&&C(c,a,l[a]);if(S)for(var a of S(l))F.call(l,a)&&C(c,a,l[a]);return c},R=(c,l)=>I(c,j(l));import{r as k,a as D,o as f,c as g,b as d,u as y,w as T,v as $,F as _,d as E,t as x,n as V,g as K,e as G,L as w,f as M,h as U,M as z,i as Y,j as q,k as X,l as P,m as O,p as b,q as Z}from"./index.cd94e2b3.js";import{C as H,S as Q,u as tt,N}from"./index.39724229.js";var et="/Taiwan_Bike_Map/assets/RoadSearch.c596cbaf.svg",st="/Taiwan_Bike_Map/assets/roadSearch_banner.3a49bd66.jpg";const ot=["src"],nt={class:"flex flex-col sm:flex-row items-center sm:space-x-5 space-y-3 sm:space-y-0"},rt=d("option",{value:"",disabled:""},"\u8ACB\u9078\u64C7\u7E23\u5E02",-1),it=["value"],at=d("option",{value:"",disabled:""},"\u8DEF\u7DDA\u9078\u64C7",-1),ct=["value"],lt=["src"],pt={emits:["emitRoadData"],setup(c,{emit:l}){const a=k(""),h=k(""),r=D(H),t=D({list:[]}),e=async()=>{s();try{const n=await K(a.value);t.list=n.map((p,i)=>R(W({},p),{id:`${p.RouteName}-${i}`}))}catch(n){console.log("Error",n)}},s=()=>{h.value=""},o=()=>{if(!a.value||!h.value)return;const n=t.list.filter(p=>p.RouteName===h.value).shift();l("emitRoadData",{selectedRoadData:n,city:a.value})};return(n,p)=>(f(),g("div",{class:"mt-16 w-full h-80vh bg-cover flex flex-col items-center justify-center",style:V(`background-image: url(${y(st)})`)},[d("img",{class:"mb-4",src:y(et),alt:"roadSearch",width:"322"},null,8,ot),d("div",nt,[T(d("select",{class:"py-3 w-80 sm:w-28 sm:mb-0 rounded-lg text-center text-content outline-0",name:"city",id:"city","onUpdate:modelValue":p[0]||(p[0]=i=>a.value=i),onChange:e,"data-test":"city"},[rt,(f(!0),g(_,null,E(y(r),i=>(f(),g("option",{key:i.value,value:i.value},x(i.option),9,it))),128))],544),[[$,a.value]]),T(d("select",{class:"py-3 w-80 sm:mb-0 rounded-lg text-center text-content outline-0",name:"road",id:"road","onUpdate:modelValue":p[1]||(p[1]=i=>h.value=i),"data-test":"road"},[at,(f(!0),g(_,null,E(y(t).list,i=>(f(),g("option",{class:"text-left",key:i.id,value:i.RouteName},x(i.RouteName),9,ct))),128))],512),[[$,h.value]]),d("button",{type:"button",onClick:o,"data-test":"submit"},[d("img",{class:"w-10 h-10",src:y(Q),alt:"search icon"},null,8,lt)])])],4))}};var ut="/Taiwan_Bike_Map/assets/CustomMarker.e9c88723.png",J={exports:{}};/** @license
 *
 *  Copyright (C) 2012 K. Arthur Endsley (kaendsle@mtu.edu)
 *  Michigan Tech Research Institute (MTRI)
 *  3600 Green Court, Suite 100, Ann Arbor, MI, 48105
 *
 *  This program is free software: you can redistribute it and/or modify
 *  it under the terms of the GNU General Public License as published by
 *  the Free Software Foundation, either version 3 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU General Public License for more details.
 *
 *  You should have received a copy of the GNU General Public License
 *  along with this program.  If not, see <http://www.gnu.org/licenses/>.
 *
 */(function(c,l){(function(a,h){c.exports=h()})(G,function(){var a,h,r;return r=function(t){if(t instanceof r)return t;if(!(this instanceof r))return new r(t);this._wrapped=t},a=function(t,e){return t.substring(0,e.length)===e},h=function(t,e){return t.substring(t.length-e.length)===e},r.delimiter=" ",r.isArray=function(t){return!!(t&&t.constructor===Array)},r.trim=function(t,e){for(e=e||" ";a(t,e);)t=t.substring(1);for(;h(t,e);)t=t.substring(0,t.length-1);return t},r.Wkt=function(t){this.delimiter=r.delimiter||" ",this.wrapVertices=!0,this.regExes={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,spaces:/\s+|\+/,numeric:/-*\d+(\.*\d+)?/,comma:/\s*,\s*/,parenComma:/\)\s*,\s*\(/,coord:/-*\d+\.*\d+ -*\d+\.*\d+/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,ogcTypes:/^(multi)?(point|line|polygon|box)?(string)?$/i,crudeJson:/^{.*"(type|coordinates|geometries|features)":.*}$/},this._stripWhitespaceAndParens=function(e){var s=e.trim(),o=s.replace(/^\(?(.*?)\)?$/,"$1");return o},this.components=void 0,t&&typeof t=="string"?this.read(t):t&&typeof t!==void 0&&this.fromObject(t)},r.Wkt.prototype.isCollection=function(){switch(this.type.slice(0,5)){case"multi":return!0;case"polyg":return!0;default:return!1}},r.Wkt.prototype.sameCoords=function(t,e){return t.x===e.x&&t.y===e.y},r.Wkt.prototype.fromObject=function(t){var e;return t.hasOwnProperty("type")&&t.hasOwnProperty("coordinates")?e=this.fromJson(t):e=this.deconstruct.call(this,t),this.components=e.components,this.isRectangle=e.isRectangle||!1,this.type=e.type,this},r.Wkt.prototype.toObject=function(t){var e=this.construct[this.type].call(this,t);return typeof e=="object"&&!r.isArray(e)&&(e.properties=this.properties),e},r.Wkt.prototype.toString=function(t){return this.write()},r.Wkt.prototype.fromJson=function(t){var e,s,o,n,p,i;if(this.type=t.type.toLowerCase(),this.components=[],t.hasOwnProperty("geometry"))return this.fromJson(t.geometry),this.properties=t.properties,this;if(n=t.coordinates,!r.isArray(n[0]))this.components.push({x:n[0],y:n[1]});else for(e in n)if(n.hasOwnProperty(e))if(!r.isArray(n[e][0]))this.type==="multipoint"?this.components.push([{x:n[e][0],y:n[e][1]}]):this.components.push({x:n[e][0],y:n[e][1]});else{i=[];for(s in n[e])if(n[e].hasOwnProperty(s))if(!r.isArray(n[e][s][0]))i.push({x:n[e][s][0],y:n[e][s][1]});else{p=[];for(o in n[e][s])n[e][s].hasOwnProperty(o)&&p.push({x:n[e][s][o][0],y:n[e][s][o][1]});i.push(p)}this.components.push(i)}return this},r.Wkt.prototype.toJson=function(){var t,e,s,o,n,p,i;if(t=this.components,e={coordinates:[],type:function(){var u,m,v;m=this.regExes.ogcTypes.exec(this.type).slice(1),v=[];for(u in m)m.hasOwnProperty(u)&&m[u]!==void 0&&v.push(m[u].toLowerCase().slice(0,1).toUpperCase()+m[u].toLowerCase().slice(1));return v}.call(this).join("")},this.type.toLowerCase()==="box"){e.type="Polygon",e.bbox=[];for(s in t)t.hasOwnProperty(s)&&(e.bbox=e.bbox.concat([t[s].x,t[s].y]));return e.coordinates=[[[t[0].x,t[0].y],[t[0].x,t[1].y],[t[1].x,t[1].y],[t[1].x,t[0].y],[t[0].x,t[0].y]]],e}for(s in t)if(t.hasOwnProperty(s))if(r.isArray(t[s])){i=[];for(o in t[s])if(t[s].hasOwnProperty(o))if(r.isArray(t[s][o])){p=[];for(n in t[s][o])t[s][o].hasOwnProperty(n)&&p.push([t[s][o][n].x,t[s][o][n].y]);i.push(p)}else t[s].length>1?i.push([t[s][o].x,t[s][o].y]):i=i.concat([t[s][o].x,t[s][o].y]);e.coordinates.push(i)}else t.length>1?e.coordinates.push([t[s].x,t[s].y]):e.coordinates=e.coordinates.concat([t[s].x,t[s].y]);return e},r.Wkt.prototype.merge=function(t){var e=this.type.slice(0,5);if(this.type!==t.type&&this.type.slice(5,this.type.length)!==t.type)throw TypeError("The input geometry types must agree or the calling this.Wkt.Wkt instance must be a multigeometry of the other");switch(e){case"point":this.components=[this.components.concat(t.components)];break;case"multi":this.components=this.components.concat(t.type.slice(0,5)==="multi"?t.components:[t.components]);break;default:this.components=[this.components,t.components];break}return e!=="multi"&&(this.type="multi"+this.type),this},r.Wkt.prototype.read=function(t){var e;if(e=this.regExes.typeStr.exec(t),e)this.type=e[1].toLowerCase(),this.base=e[2],this.ingest[this.type]&&(this.components=this.ingest[this.type].apply(this,[this.base]));else if(this.regExes.crudeJson.test(t))if(typeof JSON=="object"&&typeof JSON.parse=="function")this.fromJson(JSON.parse(t));else throw console.log("JSON.parse() is not available; cannot parse GeoJSON strings"),{name:"JSONError",message:"JSON.parse() is not available; cannot parse GeoJSON strings"};else throw console.log("Invalid WKT string provided to read()"),{name:"WKTError",message:"Invalid WKT string provided to read()"};return this},r.Wkt.prototype.write=function(t){var e,s,o;for(t=t||this.components,s=[],s.push(this.type.toUpperCase()+"("),e=0;e<t.length;e+=1){if(this.isCollection()&&e>0&&s.push(","),!this.extract[this.type])return null;o=this.extract[this.type].apply(this,[t[e]]),this.isCollection()&&this.type!=="multipoint"?s.push("("+o+")"):(s.push(o),e!==t.length-1&&this.type!=="multipoint"&&s.push(","))}return s.push(")"),s.join("")},r.Wkt.prototype.extract={point:function(t){return String(t.x)+this.delimiter+String(t.y)},multipoint:function(t){var e,s=[],o;for(e=0;e<t.length;e+=1)o=this.extract.point.apply(this,[t[e]]),this.wrapVertices&&(o="("+o+")"),s.push(o);return s.join(",")},linestring:function(t){return this.extract.point.apply(this,[t])},multilinestring:function(t){var e,s=[];if(t.length)for(e=0;e<t.length;e+=1)s.push(this.extract.linestring.apply(this,[t[e]]));else s.push(this.extract.point.apply(this,[t]));return s.join(",")},polygon:function(t){return this.extract.multilinestring.apply(this,[t])},multipolygon:function(t){var e,s=[];for(e=0;e<t.length;e+=1)s.push("("+this.extract.polygon.apply(this,[t[e]])+")");return s.join(",")},box:function(t){return this.extract.linestring.apply(this,[t])},geometrycollection:function(t){console.log("The geometrycollection WKT type is not yet supported.")}},r.Wkt.prototype.ingest={point:function(t){var e=r.trim(t).split(this.regExes.spaces);return[{x:parseFloat(this.regExes.numeric.exec(e[0])[0]),y:parseFloat(this.regExes.numeric.exec(e[1])[0])}]},multipoint:function(t){var e,s,o;for(s=[],o=r.trim(t).split(this.regExes.comma),e=0;e<o.length;e+=1)s.push(this.ingest.point.apply(this,[o[e]]));return s},linestring:function(t){var e,s,o;for(s=this.ingest.multipoint.apply(this,[t]),o=[],e=0;e<s.length;e+=1)o=o.concat(s[e]);return o},multilinestring:function(t){var e,s,o,n;for(s=[],n=r.trim(t).split(this.regExes.doubleParenComma),n.length===1&&(n=r.trim(t).split(this.regExes.parenComma)),e=0;e<n.length;e+=1)o=this._stripWhitespaceAndParens(n[e]),s.push(this.ingest.linestring.apply(this,[o]));return s},polygon:function(t){var e,s,o,n,p,i;for(i=r.trim(t).split(this.regExes.parenComma),o=[],e=0;e<i.length;e+=1){for(p=this._stripWhitespaceAndParens(i[e]).split(this.regExes.comma),n=[],s=0;s<p.length;s+=1){var u=p[s].split(this.regExes.spaces);if(u.length>2&&(u=u.filter(function(L){return L!=""})),u.length===2){var m=u[0],v=u[1];n.push({x:parseFloat(m),y:parseFloat(v)})}}o.push(n)}return o},box:function(t){var e,s,o;for(s=this.ingest.multipoint.apply(this,[t]),o=[],e=0;e<s.length;e+=1)o=o.concat(s[e]);return o},multipolygon:function(t){var e,s,o,n;for(s=[],n=r.trim(t).split(this.regExes.doubleParenComma),e=0;e<n.length;e+=1)o=this._stripWhitespaceAndParens(n[e]),s.push(this.ingest.polygon.apply(this,[o]));return s},geometrycollection:function(t){console.log("The geometrycollection WKT type is not yet supported.")}},r})})(J);var ht=J.exports;const dt={id:"geoMap",class:"w-full h-full relative z-10"},mt={props:{roadData:{type:Object,default(){return{}}}},setup(c){const l=c;let a=null,h=null;const r=300,e=new ht.Wkt().read(l.roadData.Geometry).toJson(),s=w.icon({iconUrl:ut,iconSize:[22,26]}),o=({accessToken:i,latitude:u,longitude:m})=>(a=w.map("geoMap").setView([m,u],17),w.tileLayer(`https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=${i}`,{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery \xA9 <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,accessToken:i}).addTo(a),a),n=()=>{const i={color:"red",weight:5,opacity:.65},u=w.geoJSON(e,{style:i}).addTo(a);u.addData(e),a.fitBounds(u.getBounds())},p=()=>{const i=[].concat(...e.coordinates);if(i.length>r)return;const u=i.map((m,v)=>w.marker(m.reverse(),{icon:s}));h=w.layerGroup(u),h.addTo(a)};return M(()=>{const[i]=e.coordinates[0],[u,m]=i;o({accessToken:U,latitude:u,longitude:m}),n(),p()}),(i,u)=>(f(),g("div",dt))}};var ft="/Taiwan_Bike_Map/assets/Direction.df2c1ff4.png";const yt={class:"bg-white p-10 md:p-5 lg:p-10 md:w-30% md:rounded-2xl md:shadow-lg md:shadow-gray-900"},gt={class:"mb-6 text-default text-3xl font-bold"},xt={class:"flex mb-4"},vt=["src"],wt={class:"flex mb-4"},bt=["src"],_t={class:"mb-4"},kt={class:"mb-4"},Dt={props:{roadData:{type:Object,default(){return{}}}},setup(c){const l=c;let a;const h=t=>t?t>1e3?`${t/1e3} \u516C\u91CC`:`${t} \u516C\u5C3A`:"\u672A\u63D0\u4F9B",r=()=>{const t={modalName:"RoadInfoModal",options:l.roadData};a.$eventBus.$emit("toggleModal",t)};return M(()=>{const{proxy:t}=Y();a=t}),(t,e)=>(f(),g("div",yt,[d("h1",gt,x(c.roadData.RouteName),1),d("p",xt,[d("img",{class:"w-6 mr-1.5",src:y(z),alt:"markerIcon"},null,8,vt),d("span",null," \u8ECA\u9053\u9577\u5EA6\uFF1A"+x(h(c.roadData.CyclingLength)),1)]),d("p",wt,[d("img",{class:"w-6 h-6 mr-1.5",src:y(ft),alt:"direction"},null,8,bt),d("span",null," \u884C\u8ECA\u65B9\u5411\uFF1A"+x(c.roadData.Direction?c.roadData.Direction:"\u672A\u63D0\u4F9B"),1)]),d("p",_t," \u8D77\u59CB\u9EDE\uFF1A"+x(c.roadData.RoadSectionStart?c.roadData.RoadSectionStart:"\u672A\u63D0\u4F9B"),1),d("p",kt," \u7D42\u9EDE\uFF1A"+x(c.roadData.RoadSectionEnd?c.roadData.RoadSectionEnd:"\u672A\u63D0\u4F9B"),1),d("button",{class:"w-full py-2 bg-default hover:bg-dark01 rounded-lg text-white text-xl text-center font-bold uppercase",onClick:r}," see more ")]))}},Ot={class:"w-full relative"},St={props:{roadData:{type:Object,default(){return{}}}},setup(c){const l=c,a=k(!1);q(()=>l.roadData,r=>{h(!0),X(()=>{h(!1)})});const h=r=>{a.value=r};return(r,t)=>(f(),g("div",Ot,[a.value?O("",!0):(f(),P(mt,{key:0,class:"h-80vh",roadData:c.roadData},null,8,["roadData"])),b(Dt,{class:"md:absolute md:z-30 md:right-2% md:bottom-10%",roadData:c.roadData},null,8,["roadData"])]))}},Tt={setup(c){const l=D({data:{}}),{scenicSpot:a,restaurant:h,isTourismDataReady:r,fetchTourismData:t}=tt(),e=Z(()=>Object.keys(l.data).length>0),s=({selectedRoadData:o,city:n})=>{l.data=o,t({city:n,spatialFilter:null})};return(o,n)=>(f(),g(_,null,[b(pt,{onEmitRoadData:s}),y(e)?(f(),P(St,{key:0,roadData:y(l).data},null,8,["roadData"])):O("",!0),y(r)?(f(),g(_,{key:1},[b(N,{title:"\u9644\u8FD1\u666F\u9EDE",tourismList:y(a).list},null,8,["tourismList"]),b(N,{title:"\u9644\u8FD1\u7F8E\u98DF",tourismList:y(h).list},null,8,["tourismList"])],64)):O("",!0)],64))}};export{Tt as default};
